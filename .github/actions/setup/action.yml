---
name: Set up environment

inputs:
  bazel-version:
    description: Bazel version
    required: true

runs:
  using: composite
  steps:
    - name: Generate .bazelversion
      shell: bash
      run: |
        echo "${BAZEL_VERSION}" > .bazelversion
        echo "${BAZEL_VERSION}" > examples/.bazelversion
        for integration_dir in $(find tests/integration -mindepth 1 -maxdepth 1 -type d); do
          echo "${BAZEL_VERSION}" > "${integration_dir}/.bazelversion"
        done
      env:
        BAZEL_VERSION: ${{ inputs.bazel-version }}
    - name: Install bazelisk
      uses: yuyawk/github-actions/install-bazelisk@v1
